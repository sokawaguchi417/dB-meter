<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Decibel Level Meter</title>
</head>
<body>
<h1>Decibel Level Meter</h1>
<div id="decibel-meter">0 dB</div>
<button id="start-button">Start Measuring</button>

<script>
  let audioContext = new (window.AudioContext || window.webkitAudioContext)();
  let analyser = audioContext.createAnalyser();
  let microphone;
  let javascriptNode;

  // Start measuring when the button is clicked
  document.getElementById('start-button').addEventListener('click', function() {
    navigator.mediaDevices.getUserMedia({ audio: true, video: false })
      .then(function(stream) {
        microphone = audioContext.createMediaStreamSource(stream);
        microphone.connect(analyser);
        javascriptNode = audioContext.createScriptProcessor(2048, 1, 1);

        analyser.smoothingTimeConstant = 0.8;
        analyser.fftSize = 1024;

        microphone.connect(analyser);
        analyser.connect(javascriptNode);
        javascriptNode.connect(audioContext.destination);

        javascriptNode.onaudioprocess = function() {
          let array = new Uint8Array(analyser.frequencyBinCount);
          analyser.getByteFrequencyData(array);
          let values = 0;

          let length = array.length;
          for (let i = 0; i < length; i++) {
            values += (array[i]);
          }

          let average = values / length;
          // Convert the value to decibels
          let db = Math.round(average);
          document.getElementById('decibel-meter').innerText = db + ' dB';
        }
      })
      .catch(function(err) {
        /* handle the error */
        console.error(err);
      });
  });
</script>
</body>
</html>
